# CU 행사 데이터 수집 모듈 PRD

## 1. 서비스 개요
* **목적**: CU의 행사 상품 정보를 수집하여 타 편의점 데이터와 결합, 소비자에게 최저 '실질 단가' 정보를 제공.
* **대상**: CU 공식 홈페이지 내 플러스 행사(1+1, 2+1 등) 상품 데이터.

## 2. 데이터 수집 및 저장 명세
### 2.1 수집 데이터 (Output Schema)
| 열 이름 | 설명 | 예시 |
| :--- | :--- | :--- |
| **brand** | 편의점 브랜드명 (고정값: 'CU') | CU |
| **name** | 상품 이름 | 코카콜라 500ml |
| **price** | 판매 가격 (정수형) | 2000 |
| **event** | 행사 종류 | 1+1 |
| **img_url** | 상품 이미지 절대 경로 URL | https://... |

### 2.2 저장 형식
* **파일 형식**: CSV
* **인코딩**: `utf-8-sig` (엑셀 한글 깨짐 방지)
* **파일명 규칙**: `브랜드명_YYMMDD.csv`
    * 예시: `CU_260223.csv` (2026년 2월 23일 수집 시)

## 3. 기술적 구현 상세
### 3.1 수집 전략
* **데이터 소스**: CU 공식 홈페이지의 이벤트 Ajax 엔드포인트 (`plusAjax.do`) 활용.
* **요청 방식**: HTTP POST 요청 (Payload: `pageIndex`, `listType="01"`)
* **파싱 라이브러리**: BeautifulSoup4 (HTML 파싱), re (데이터 클렌징)

### 3.2 주요 셀렉터 명세
* **상품 리스트**: `li.prod_list`
* **상품명**: `.name p`
* **가격**: `.price strong`
* **행사 종류**: `li[class*='eventInfo'] a`
* **이미지 URL**: `.prod_img img`

## 4. 실질 단가(Net Unit Price) 계산 정의
타 브랜드와의 비교를 위해 다음 수식을 시스템 표준으로 정의함:
* **1+1**: `판매가 * 1 / 2` (50% 할인 효과)
* **2+1**: `판매가 * 2 / 3` (약 33.3% 할인 효과)
* **3+1**: `판매가 * 3 / 4` (25% 할인 효과)
* **증정**: `판매가 / 1` (본 상품 기준 단가)

## 5. 데이터 품질 및 예외 처리 전략
* **수집 주기**: 매월 1일 정기 수집 및 주간 단위 업데이트.
* **지연 시간 설정**: 서버 부하 방지를 위해 페이지당 1초의 `sleep` 적용.
* **데이터 정제**: 정규표현식을 통해 가격 데이터의 특수문자 제거 및 정수화.
* **인코딩**: 엑셀 호환성을 위해 `utf-8-sig` 적용.
